{"dependencies":[{"name":"./util.js","loc":{"line":17,"column":23}},{"name":"./Tile.js","loc":{"line":18,"column":17}},{"name":"./dom.js","loc":{"line":19,"column":38}},{"name":"./events.js","loc":{"line":20,"column":30}}],"generated":{"js":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _util = require(\"./util.js\");\n\nvar _Tile = require(\"./Tile.js\");\n\nvar _Tile2 = _interopRequireDefault(_Tile);\n\nvar _dom = require(\"./dom.js\");\n\nvar _events = require(\"./events.js\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar __extends = undefined && undefined.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n    return extendStatics(d, b);\n  };\n  return function (d, b) {\n    extendStatics(d, b);\n    function __() {\n      this.constructor = d;\n    }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n/**\n * @module ol/VectorRenderTile\n */\n\n/**\n * @typedef {Object} ReplayState\n * @property {boolean} dirty\n * @property {null|import(\"./render.js\").OrderFunction} renderedRenderOrder\n * @property {number} renderedTileRevision\n * @property {number} renderedResolution\n * @property {number} renderedRevision\n * @property {number} renderedZ\n * @property {number} renderedTileResolution\n * @property {number} renderedTileZ\n */\nvar VectorRenderTile = /** @class */function (_super) {\n  __extends(VectorRenderTile, _super);\n  /**\n   * @param {import(\"./tilecoord.js\").TileCoord} tileCoord Tile coordinate.\n   * @param {import(\"./TileState.js\").default} state State.\n   * @param {import(\"./tilecoord.js\").TileCoord} urlTileCoord Wrapped tile coordinate for source urls.\n   * @param {import(\"./tilegrid/TileGrid.js\").default} sourceTileGrid Tile grid of the source.\n   * @param {function(VectorRenderTile):Array<import(\"./VectorTile\").default>} getSourceTiles Function\n   * to get an source tiles for this tile.\n   * @param {function(VectorRenderTile):void} removeSourceTiles Function to remove this tile from its\n   * source tiles's consumer count.\n   */\n  function VectorRenderTile(tileCoord, state, urlTileCoord, sourceTileGrid, getSourceTiles, removeSourceTiles) {\n    var _this = _super.call(this, tileCoord, state, { transition: 0 }) || this;\n    /**\n     * @private\n     * @type {!Object<string, CanvasRenderingContext2D>}\n     */\n    _this.context_ = {};\n    /**\n     * Executor groups by layer uid. Entries are read/written by the renderer.\n     * @type {Object<string, Array<import(\"./render/canvas/ExecutorGroup.js\").default>>}\n     */\n    _this.executorGroups = {};\n    /**\n     * Number of loading source tiles. Read/written by the source.\n     * @type {number}\n     */\n    _this.loadingSourceTiles = 0;\n    /**\n     * Tile keys of error source tiles. Read/written by the source.\n     * @type {Object<string, boolean>}\n     */\n    _this.errorSourceTileKeys = {};\n    /**\n     * @type {ImageData}\n     */\n    _this.hitDetectionImageData = null;\n    /**\n     * @private\n     * @type {!Object<string, ReplayState>}\n     */\n    _this.replayState_ = {};\n    /**\n     * @type {number}\n     */\n    _this.wantedResolution;\n    /**\n     * @type {!function():Array<import(\"./VectorTile.js\").default>}\n     */\n    _this.getSourceTiles = getSourceTiles.bind(_this, _this);\n    /**\n     * @type {!function(import(\"./VectorRenderTile.js\").default):void}\n     */\n    _this.removeSourceTiles_ = removeSourceTiles;\n    /**\n     * @private\n     * @type {import(\"./tilegrid/TileGrid.js\").default}\n     */\n    _this.sourceTileGrid_ = sourceTileGrid;\n    /**\n     * @type {Array<import(\"./events.js\").EventsKey>}\n     */\n    _this.sourceTileListenerKeys = [];\n    /**\n     * z of the source tiles of the last getSourceTiles call.\n     * @type {number}\n     */\n    _this.sourceZ = -1;\n    /**\n     * True when all tiles for this tile's nominal resolution are available.\n     * @type {boolean}\n     */\n    _this.hifi = false;\n    /**\n     * @type {import(\"./tilecoord.js\").TileCoord}\n     */\n    _this.wrappedTileCoord = urlTileCoord;\n    return _this;\n  }\n  /**\n   * @inheritDoc\n   */\n  VectorRenderTile.prototype.disposeInternal = function () {\n    this.sourceTileListenerKeys.forEach(_events.unlistenByKey);\n    this.sourceTileListenerKeys.length = 0;\n    this.removeSourceTiles_(this);\n    for (var key in this.context_) {\n      var canvas = this.context_[key].canvas;\n      canvas.width = 0;\n      canvas.height = 0;\n    }\n    for (var key in this.executorGroups) {\n      var executorGroups = this.executorGroups[key];\n      for (var i = 0, ii = executorGroups.length; i < ii; ++i) {\n        executorGroups[i].disposeInternal();\n      }\n    }\n    _super.prototype.disposeInternal.call(this);\n  };\n  /**\n   * @param {import(\"./layer/Layer.js\").default} layer Layer.\n   * @return {CanvasRenderingContext2D} The rendering context.\n   */\n  VectorRenderTile.prototype.getContext = function (layer) {\n    var key = (0, _util.getUid)(layer);\n    if (!(key in this.context_)) {\n      this.context_[key] = (0, _dom.createCanvasContext2D)();\n    }\n    return this.context_[key];\n  };\n  /**\n   * @param {import(\"./layer/Layer.js\").default} layer Layer.\n   * @return {boolean} Tile has a rendering context for the given layer.\n   */\n  VectorRenderTile.prototype.hasContext = function (layer) {\n    return (0, _util.getUid)(layer) in this.context_;\n  };\n  /**\n   * Get the Canvas for this tile.\n   * @param {import(\"./layer/Layer.js\").default} layer Layer.\n   * @return {HTMLCanvasElement} Canvas.\n   */\n  VectorRenderTile.prototype.getImage = function (layer) {\n    return this.hasContext(layer) ? this.getContext(layer).canvas : null;\n  };\n  /**\n   * @param {import(\"./layer/Layer.js\").default} layer Layer.\n   * @return {ReplayState} The replay state.\n   */\n  VectorRenderTile.prototype.getReplayState = function (layer) {\n    var key = (0, _util.getUid)(layer);\n    if (!(key in this.replayState_)) {\n      this.replayState_[key] = {\n        dirty: false,\n        renderedRenderOrder: null,\n        renderedResolution: NaN,\n        renderedRevision: -1,\n        renderedTileResolution: NaN,\n        renderedTileRevision: -1,\n        renderedZ: -1,\n        renderedTileZ: -1\n      };\n    }\n    return this.replayState_[key];\n  };\n  /**\n   * @inheritDoc\n   */\n  VectorRenderTile.prototype.load = function () {\n    this.getSourceTiles();\n  };\n  return VectorRenderTile;\n}(_Tile2.default);\nexports.default = VectorRenderTile;\n//# sourceMappingURL=VectorRenderTile.js.map"},"hash":"df34b470455f31e8c9c2a1defa783353"}